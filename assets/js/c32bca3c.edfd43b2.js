"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[3233],{3905:function(t,e,n){n.d(e,{Zo:function(){return p},kt:function(){return d}});var a=n(7294);function i(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function l(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function r(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?l(Object(n),!0).forEach((function(e){i(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function c(t,e){if(null==t)return{};var n,a,i=function(t,e){if(null==t)return{};var n,a,i={},l=Object.keys(t);for(a=0;a<l.length;a++)n=l[a],e.indexOf(n)>=0||(i[n]=t[n]);return i}(t,e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);for(a=0;a<l.length;a++)n=l[a],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(i[n]=t[n])}return i}var o=a.createContext({}),s=function(t){var e=a.useContext(o),n=e;return t&&(n="function"==typeof t?t(e):r(r({},e),t)),n},p=function(t){var e=s(t.components);return a.createElement(o.Provider,{value:e},t.children)},u={inlineCode:"code",wrapper:function(t){var e=t.children;return a.createElement(a.Fragment,{},e)}},g=a.forwardRef((function(t,e){var n=t.components,i=t.mdxType,l=t.originalType,o=t.parentName,p=c(t,["components","mdxType","originalType","parentName"]),g=s(n),d=i,m=g["".concat(o,".").concat(d)]||g[d]||u[d]||l;return n?a.createElement(m,r(r({ref:e},p),{},{components:n})):a.createElement(m,r({ref:e},p))}));function d(t,e){var n=arguments,i=e&&e.mdxType;if("string"==typeof t||i){var l=n.length,r=new Array(l);r[0]=g;var c={};for(var o in e)hasOwnProperty.call(e,o)&&(c[o]=e[o]);c.originalType=t,c.mdxType="string"==typeof t?t:i,r[1]=c;for(var s=2;s<l;s++)r[s]=n[s];return a.createElement.apply(null,r)}return a.createElement.apply(null,n)}g.displayName="MDXCreateElement"},9592:function(t,e,n){n.r(e),n.d(e,{frontMatter:function(){return c},contentTitle:function(){return o},metadata:function(){return s},toc:function(){return p},default:function(){return g}});var a=n(7462),i=n(3366),l=(n(7294),n(3905)),r=["components"],c={slug:"google-guice-source",title:"Google guice \u6846\u67b6\u6e90\u7801\u5b66\u4e60",tags:["java","DI","IOC"],authors:["jeesk"]},o=void 0,s={unversionedId:"google-guice/2020-04-16-google-juice-source",id:"google-guice/2020-04-16-google-juice-source",title:"Google guice \u6846\u67b6\u6e90\u7801\u5b66\u4e60",description:"1. Google Guice \u6846\u67b6\u7b80\u4ecb",source:"@site/docs/google-guice/2020-04-16-google-juice-source.md",sourceDirName:"google-guice",slug:"/google-guice/google-guice-source",permalink:"/docs/google-guice/google-guice-source",editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/google-guice/2020-04-16-google-juice-source.md",tags:[{label:"java",permalink:"/docs/tags/java"},{label:"DI",permalink:"/docs/tags/di"},{label:"IOC",permalink:"/docs/tags/ioc"}],version:"current",frontMatter:{slug:"google-guice-source",title:"Google guice \u6846\u67b6\u6e90\u7801\u5b66\u4e60",tags:["java","DI","IOC"],authors:["jeesk"]},sidebar:"tutorialSidebar",previous:{title:"\u9605\u8bfb\u8bf4\u660e",permalink:"/docs/intro"},next:{title:"spring\u5bb9\u5668\u76f8\u5173\u9605\u8bfb",permalink:"/docs/spring/spring-container"}},p=[{value:"1. Google Guice \u6846\u67b6\u7b80\u4ecb",id:"1-google-guice-\u6846\u67b6\u7b80\u4ecb",children:[],level:2},{value:"2. \u5982\u4f55Bean\u521b\u5efa\u548c\u7ba1\u7406",id:"2-\u5982\u4f55bean\u521b\u5efa\u548c\u7ba1\u7406",children:[{value:"1.  \u521b\u5efaContainerBuilder",id:"1--\u521b\u5efacontainerbuilder",children:[],level:3},{value:"2. \u521b\u5efa\u5bb9\u5668",id:"2-\u521b\u5efa\u5bb9\u5668",children:[],level:3},{value:"3.\t\u83b7\u53d6\u5b9e\u4f8b",id:"3\u83b7\u53d6\u5b9e\u4f8b",children:[],level:3},{value:"4.  \u5c0f\u7ed3",id:"4--\u5c0f\u7ed3",children:[],level:3}],level:2},{value:"3. \u4f9d\u8d56\u6ce8\u5165\u5982\u4f55\u5b9e\u73b0",id:"3-\u4f9d\u8d56\u6ce8\u5165\u5982\u4f55\u5b9e\u73b0",children:[{value:"1.\t\u9996\u5148\u521b\u5efa\u5bf9\u8c61",id:"1\u9996\u5148\u521b\u5efa\u5bf9\u8c61",children:[],level:3},{value:"2.\t\u6ce8\u5165\u5b57\u6bb5",id:"2\u6ce8\u5165\u5b57\u6bb5",children:[],level:3},{value:"3.\t\u5c0f\u7ed3",id:"3\u5c0f\u7ed3",children:[],level:3}],level:2},{value:"4. \u5904\u7406\u4f9d\u8d56\u5faa\u73af",id:"4-\u5904\u7406\u4f9d\u8d56\u5faa\u73af",children:[{value:"1.\t\u5148\u521b\u5efaAImpl\u7684\u6784\u9020\u5668",id:"1\u5148\u521b\u5efaaimpl\u7684\u6784\u9020\u5668",children:[],level:4},{value:"2.\t\u5f53\u53d1\u73b0\u81ea\u5df1\u7684\u6784\u9020\u5668\u53c2\u6570\u91cc\u9762\u6709\u5176\u5b83\u53c2\u6570\u65f6\uff0c\u5148\u521b\u5efa\u53c2\u6570\u5bf9\u8c61",id:"2\u5f53\u53d1\u73b0\u81ea\u5df1\u7684\u6784\u9020\u5668\u53c2\u6570\u91cc\u9762\u6709\u5176\u5b83\u53c2\u6570\u65f6\u5148\u521b\u5efa\u53c2\u6570\u5bf9\u8c61",children:[],level:4},{value:"3. \u53c2\u6570\u5bf9\u8c61\u521b\u5efa\u5b8c\u6210\u540e, \u518d\u521b\u5efaAImpl\u5b9e\u4f8b\u5bf9\u8c61\uff0c\u540c\u65f6\u5c06\u6301\u6709AImpl\u7684\u4ee3\u7406\u5bf9\u8c61\u91cd\u65b0\u8bbe\u7f6e\u4e3a\u65b0\u7684Aimpl\u7684\u5b9e\u4f8b\u5bf9\u8c61",id:"3-\u53c2\u6570\u5bf9\u8c61\u521b\u5efa\u5b8c\u6210\u540e-\u518d\u521b\u5efaaimpl\u5b9e\u4f8b\u5bf9\u8c61\u540c\u65f6\u5c06\u6301\u6709aimpl\u7684\u4ee3\u7406\u5bf9\u8c61\u91cd\u65b0\u8bbe\u7f6e\u4e3a\u65b0\u7684aimpl\u7684\u5b9e\u4f8b\u5bf9\u8c61",children:[],level:4},{value:"4. \u5c0f\u7ed3",id:"4-\u5c0f\u7ed3",children:[],level:4}],level:2},{value:"5. \u9759\u6001\u6ce8\u5165",id:"5-\u9759\u6001\u6ce8\u5165",children:[],level:2},{value:"6. guice \u548cspring \u4f7f\u7528DI \u548cIOC \u901f\u5ea6\u5bf9\u6bd4",id:"6-guice-\u548cspring-\u4f7f\u7528di-\u548cioc-\u901f\u5ea6\u5bf9\u6bd4",children:[],level:2},{value:"7. \u603b\u7ed3",id:"7-\u603b\u7ed3",children:[],level:2}],u={toc:p};function g(t){var e=t.components,c=(0,i.Z)(t,r);return(0,l.kt)("wrapper",(0,a.Z)({},u,c,{components:e,mdxType:"MDXLayout"}),(0,l.kt)("h2",{id:"1-google-guice-\u6846\u67b6\u7b80\u4ecb"},"1. Google Guice \u6846\u67b6\u7b80\u4ecb"),(0,l.kt)("blockquote",null,(0,l.kt)("p",{parentName:"blockquote"},"\u200b\t\u672c\u6587\u6709\u5927\u91cf\u7684\u622a\u56fe\u548c\u89e3\u91ca\uff0c \u4e0d\u59a8\u7528idea\u8fb9\u8c03\u8bd5\u8fb9\u770b\u6587\u7ae0\u3002 ")),(0,l.kt)("p",null,"\u200b\t\u5728\u5b66\u4e60 ",(0,l.kt)("inlineCode",{parentName:"p"},"Spring")," \u7684\u65f6\u5019\uff0c \u6211\u4eec\u5e38\u5e38\u4e60\u60ef\u7528 ",(0,l.kt)("inlineCode",{parentName:"p"},"@Bean")," \u5c06Bean\u7684\u521b\u5efa\u4ea4\u7ed9spirng \u6765\u7ba1\u7406\uff0c \u4f7f\u7528 ",(0,l.kt)("inlineCode",{parentName:"p"},"@Autowire")," \u5b9e\u73b0\u4f9d\u8d56\u81ea\u52a8\u6ce8\u5165Bean\u3002"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},"@Configuration\nclass MyBean{\n @Bean\n public Person person {\n     return new Person();\n }\n}\n\nclass ABCService {\n    @Autowore\n    private Person Person;\n}\n")),(0,l.kt)("p",null,"\u200b\t\t\u5728Spring \u7684\u9879\u76ee\u4e2d\u53ef\u4ee5\u968f\u4fbf\u4f7f\u7528\uff0c \u5728\u6ca1\u6709Spring \u7684\u9879\u76ee\u4f7f\u7528 DI \u548cIOC \uff0c\u8981\u5f15\u5165 ",(0,l.kt)("inlineCode",{parentName:"p"},"spring-core")," , \u663e\u5f97\u4e0d\u662f\u90a3\u4e48\u53cb\u597d\uff0c\u4e00\u4e9b\u4e0d\u60f3\u7528spring \u6846\u67b6\u7684\u516c\u53f8\u5c31\u4f1a\u9020\u51fa\u4e00\u4e9b\u8f6e\u5b50\uff0c\u6bd4\u5982Google \u516c\u53f8\u51fa\u4e86\u4e00\u6b3e\u8f7b\u91cf\u7684IOC \u6846\u67b6\uff0c \u4e0b\u9762\u6211\u4eec\u6765\u7814\u7a76\u7814\u7a76\u3002"),(0,l.kt)("p",null,"\u672c\u6587\u6e90\u7801\u5c06\u4f1a\u4f7f\u7528 google juice \u7684\u7b2c\u4e00\u4e2a\u7248\u672c\u7248\u672c\u53f7\u4e3a\uff1a",(0,l.kt)("inlineCode",{parentName:"p"},"66b415a2066cac9f36ed58070777de388f63a3a4 "),"\uff0c\u8fd9\u4e2a\u7248\u672c\u5927\u7ea6\u572820\u4e2a\u7c7b\u5de6\u53f3\uff0c\u57fa\u4e8ejdk 1.5\u7684\uff0c\u8fd9\u4e2a\u7248\u672c\u4ee3\u7801\u76f8\u5bf9\u6765\u8bf4\u975e\u5e38\u5c11\u3002  \u4e0b\u9762\u6211\u4eec\u5e26\u7740\u76ee\u7684\u53bb\u7814\u7a76\u4ee3\u7801\u3002"),(0,l.kt)("h2",{id:"2-\u5982\u4f55bean\u521b\u5efa\u548c\u7ba1\u7406"},"2. \u5982\u4f55Bean\u521b\u5efa\u548c\u7ba1\u7406"),(0,l.kt)("p",null,"\u4e0b\u9762\u662fguice\u6846\u67b6\u5c06Bar\u63a5\u53e3\u548c\u5b9e\u73b0\u7c7bBarImpl\u7ed1\u5b9a\u7684\u4ee3\u7801\uff0c\u5e76\u4e14\u83b7\u53d6Bar\u7c7b\u578b\u7684\u5b9e\u4f8b\u5bf9\u8c61\u3002"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},"  public void testManageBean(){\n    ContainerBuilder builder = new ContainerBuilder();\n    builder.factory(Bar.class, BarImpl.class);\n    Container container = builder.create(false);\n    Bar instance = container.getInstance(Bar.class);\n    System.out.println(instance);\n  }\n")),(0,l.kt)("p",null,"\u200b\t    \u9996\u5148\u521b\u5efa\u4e86\u4e00\u4e2a\u5bb9\u5668Builder\uff0c \u518d\u5c06Bar \u548cBarImpl \u653e\u5165factory \u65b9\u6cd5\u4e2d\uff0c \u518d\u8c03\u7528create() \u521b\u5efa\u51fa\u5bb9\u5668\uff0c \u6700\u540e\u901a\u8fc7getInstance() \u65b9\u6cd5\u6765\u83b7\u53d6\u5b9e\u4f8b\u3002\u4e0b\u9762\u770b\u6846\u67b6\u4ee3\u7801\u662f\u5982\u4f55\u5b9e\u73b0\u7684\u3002"),(0,l.kt)("h3",{id:"1--\u521b\u5efacontainerbuilder"},"1.  \u521b\u5efaContainerBuilder"),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"ContainerBuilder builder = new ContainerBuilder();")),(0,l.kt)("p",null,"\u9996\u5148\u770b\u770b\u6ce8\u91ca"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-english"},"Builds a dependency injection {@link Container}. The combination of\n dependency type and name uniquely identifies a dependency mapping; you can\nuse the same name for two different types. Not safe for concurrent use.\n")),(0,l.kt)("p",null,"\u6784\u5efa\u4e00\u4e2a\u4f9d\u8d56\u6ce8\u5165\uff0c \u4f9d\u8d56\u7684\u7c7b\u578b\u548c\u552f\u4e00\u7684\u540d\u5b57\u4f5c\u4e3a\u6620\u5c04\uff0c\u4e24\u4e2a\u4e0d\u540c\u7684\u7c7b\u578b\u53ef\u4ee5\u4f7f\u7528\u540c\u4e00\u4e2a\u540d\u5b57\uff08\u597d\u50cfspring \u4e0d\u53ef\u4ee5\u8fd9\u6837\uff09\uff0c \u8fd9\u4e2a\u7c7b\u5e76\u53d1\u4e0d\u5b89\u5168\u3002"),(0,l.kt)("p",null,"\u8fd9\u91cc\u8bf4\u4e00\u4e0bContainerBuilder \u91cc\u9762\u7684\u4e09\u4e2a\u53d8\u91cf\uff0c \u540e\u9762\u4f1a\u7528\u5230\u3002"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},"  final Map<Key<?>, InternalFactory<?>> factories =   new HashMap<Key<?>, InternalFactory<?>>();\n  final List<InternalFactory<?>> singletonFactories = new ArrayList<InternalFactory<?>>();\n  final List<Class<?>> staticInjections = new ArrayList<Class<?>>();\n  boolean created;\n")),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},"factories             \u63a5\u53e3\u7c7b\u578b\u548c\u5b9e\u4f8b\u5de5\u5382\u7684\u6620\u5c04"),(0,l.kt)("li",{parentName:"ol"},"singletonFactories    \u5355\u4f8bbean\u7684\u5de5\u5382\uff0c \u6240\u6709\u751f\u547d\u5468\u671f\u662f\u5355\u4f8b\u7684\u90fd\u4f1a\u52a0\u5165\u8fd9\u4e2a\u96c6\u5408"),(0,l.kt)("li",{parentName:"ol"},"staticInjections  \u9700\u8981\u9759\u6001\u6ce8\u5165\u7684Class \u7c7b\u96c6\u5408"),(0,l.kt)("li",{parentName:"ol"},"created               \u8868\u793a\u8be5\u5bb9\u5668\u662f\u5426\u5df2\u7ecf\u521b\u5efa\uff0c\u56e0\u4e3a\u5bb9\u5668\u662f\u662f\u975e\u7ebf\u7a0b\u5b89\u5168\uff0c\u6240\u4ee5\u7528\u8fd9\u4e2a\u5b57\u6bb5\u6807\u8bb0\u4e00\u4e0b")),(0,l.kt)("p",null,"\u4e0b\u9762\u5f00\u542fidea debug \u6a21\u5f0f\u8d70\u8d77\u3002"),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},"builder.factory(Bar.class, BarImpl.class);"),(0,l.kt)("p",{parentName:"li"},(0,l.kt)("img",{alt:"image-20220416135734557",src:n(890).Z,width:"519",height:"160"})),(0,l.kt)("ol",{parentName:"li"},(0,l.kt)("li",{parentName:"ol"},"\u200b\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\u56fe1")))),(0,l.kt)("p",null,(0,l.kt)("img",{alt:"image-20220416135800301",src:n(8421).Z,width:"622",height:"271"})),(0,l.kt)("p",null,"\u200b\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\u56fe2"),(0,l.kt)("p",null,(0,l.kt)("img",{alt:"image-20220416135815906",src:n(430).Z,width:"691",height:"187"})),(0,l.kt)("p",null,"\u200b\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\u56fe3"),(0,l.kt)("p",null,"\u4ece\u4ee3\u7801\u53d1\u73b0\u4e86\u65b9\u6cd5\u518d\u6b21\u91cd\u8f7d\uff0c \u540c\u65f6\u7ed9\u5bb9\u5668\u8bbe\u7f6e\u4e86\u4e00\u4e2a\u9ed8\u8ba4\u7684\u540d\u5b57\u3002 \u4e0b\u9762\u518d\u8fdbfactory() \u65b9\u6cd5\u91cc\u9762\u770b"),(0,l.kt)("p",null,(0,l.kt)("img",{alt:"image-20220416140009260",src:n(1688).Z,width:"1081",height:"635"})),(0,l.kt)("p",null,"\u200b\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\u56fe4"),(0,l.kt)("p",null,"201\u884c\u7684\u4ee3\u7801\u751f\u6210\u4e86\u4e00\u4e2a\u5de5\u5382\u7c7b\uff0c \u8fd9\u4e2a\u5de5\u5382\u7c7b\u901a\u8fc7\u6784\u9020\u5668\u521b\u5efa\u4e00\u4e2a\u5b9e\u4f8b\u3002\u540c\u65f6\u5b9e\u73b0\u7c7b\u653e\u5230\u4e86implementation  \u5b57\u6bb5\u91cc\u9762\u4e86\u3002 \u518d\u7ee7\u7eeddebug"),(0,l.kt)("p",null,(0,l.kt)("img",{alt:"image-20220416140517464",src:n(6879).Z,width:"736",height:"542"})),(0,l.kt)("p",null,"\u200b\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\u56fe5"),(0,l.kt)("p",null,"\u7b2c92 \u884c\u628akey\u548c\u5bf9\u5e94\u7684\u751f\u547d\u5468\u671f\u5de5\u5382\u7c7b\u653e\u5165\u4e86\u4e00\u4e2a\u88ab\u5c01\u88c5\u540e\u7684\u5de5\u5382\uff0c\u8fd9\u91cc\u4e3a\u4ec0\u4e48\u4f1a\u7528scope \u6765\u5c01\u88c5\u4e00\u4e0b\u5462\uff1f \u4e3b\u8981\u662f\u56e0\u4e3a\u4e0d\u540c\u7684\u751f\u547d\u5468\u671f\u6709\u4e0d\u540c\u7684\u521b\u5efa\u65b9\u5f0f\u3002 \u6bd4\u5982\u5355\u4f8b\u53ea\u9700\u8981\u521b\u5efa\u4e00\u6b21\u5373\u53ef\u3002\u4ece\u4e0b\u56fe\u7684\u4ee3\u7801\u768447\u884c\u4e2d\u53ef\u4ee5\u770b\u5230Singleton \u7684 scopeFactory  \u65b9\u6cd5\u52a0\u4e86\u9501\uff0c \u8fd9\u662f\u4fdd\u8bc1\u5355\u4f8b\u5b89\u5168\u3002"),(0,l.kt)("p",null,(0,l.kt)("img",{alt:"image-20220416140847252",src:n(1679).Z,width:"1080",height:"469"})),(0,l.kt)("p",null,"\u200b\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\u56fe6"),(0,l.kt)("p",null,"\u9ed8\u8ba4\u5de5\u5382\uff0c\u76f4\u63a5\u8fd4\u56de\u5de5\u5382\u5c31\u884c\u3002"),(0,l.kt)("p",null,(0,l.kt)("img",{alt:"image-20220416140923405",src:n(902).Z,width:"766",height:"193"})),(0,l.kt)("p",null,"\u200b\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\u56fe7"),(0,l.kt)("h3",{id:"2-\u521b\u5efa\u5bb9\u5668"},"2. \u521b\u5efa\u5bb9\u5668"),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"builder.create(false)")),(0,l.kt)("p",null,(0,l.kt)("img",{alt:"image-20220416142457081",src:n(8501).Z,width:"844",height:"458"})),(0,l.kt)("p",null,"\u200b\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\u56fe8"),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},"ensureNotCreated \u56e0\u4e3aBuilder\u4e0d\u662f\u7ebf\u7a0b\u5b89\u5168\u7684\uff0c\u6240\u4ee5\u5148\u786e\u4fdd\u4e0d\u4f1a\u88ab\u521b\u5efa\u3002\u5c06factoryies  \u653e\u5165ContainerImpl \u91cc\u9762\uff0c \u56e0\u4e3aloadSingletons\u662ffalse\uff0c \u540c\u65f6\u6211\u4eec\u4e5f\u6ca1\u6709\u9759\u6001\u5b57\u6bb5(\u8fd9\u4e24\u884c\u4ee3\u7801\u5148\u4e0d\u5173\u6ce8\uff0c\u540e\u9762\u4f1a\u8bf4\uff09\u3002\u6240\u4ee5\u76f4\u63a5\u5c06\u5bb9\u5668\u8fd4\u56de\u3002")),(0,l.kt)("h3",{id:"3\u83b7\u53d6\u5b9e\u4f8b"},"3.\t\u83b7\u53d6\u5b9e\u4f8b"),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"Bar instance = container.getInstance(Bar.class);")),(0,l.kt)("p",null,(0,l.kt)("img",{alt:"image-20220416143220942",src:n(6755).Z,width:"802",height:"850"})),(0,l.kt)("p",null,"\u200b\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\u56fe9"),(0,l.kt)("p",null,"\u200b\t\t\t\t\t\tcallable.call(reference","[0]",") \u56de\u8c03\u4e86487\u884c\u7684getInstance(type, context)\uff0c \u518d\u7ee7\u7eed\u6df1\u5165"),(0,l.kt)("p",null,"\u200b\t\t\t",(0,l.kt)("img",{alt:"image-20220416143523366",src:n(7455).Z,width:"912",height:"500"})),(0,l.kt)("p",null,"\u200b\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\u56fe10"),(0,l.kt)("p",null,"447 \u884c\u4ee3\u7801\u4f7f\u7528Bar\u7684Class\u7c7b\u578b\u548c\u540d\u5b57\u521b\u5efa\u4e86\u4e2aKey\u7c7b\u578b\u5b9e\u4f8b\uff0c \u901a\u8fc7key\u5bf9\u8c61\u53bbfactories \u5bf9\u8c61\u91cc\u9762\u62ff\u5230\u5bf9\u5e94\u7684\u5de5\u5382\u7c7b\uff0c \u518d\u521b\u5efaBar\u5b9e\u73b0\u7684\u5b9e\u4f8b\u3002 \u6beb\u65e0\u7591\u95ee\u4e0b\u9762\u53c8\u4f1a\u8c03\u7528\u521b\u5efa\u5b9e\u4f8b\u7684create\u65b9\u6cd5\u3002"),(0,l.kt)("p",null,(0,l.kt)("img",{alt:"image-20220416143746681",src:n(2756).Z,width:"1361",height:"404"})),(0,l.kt)("p",null,"\u200b\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\u56fe11"),(0,l.kt)("h3",{id:"4--\u5c0f\u7ed3"},"4.  \u5c0f\u7ed3"),(0,l.kt)("p",null,"\u200b\t\tguice\u5c06\u63a5\u53e3\u7684\u7c7b\u578b\uff0c\u540d\u5b57\u7b49\u751f\u6210\u4e00\u4e2akey\uff0c \u7136\u540e\u751f\u6210\u8be5\u63a5\u53e3\u5b9e\u73b0\u7c7b\u7684\u5de5\u5382\u7c7b\uff0c \u540c\u65f6\u5c06Key\u548c\u5de5\u5382\u7c7b\u5b9e\u4f8b\u653e\u5165map\u91cc\u9762\uff0c \u518d\u5c06map\u653e\u5165\u5bb9\u5668\u7c7b\u91cc\u9762\u3002\u5f53Containner.getInsance() \u83b7\u53d6\u5b9e\u4f8b\u7684\u65f6\u5019\uff0c \u9996\u5148\u901a\u8fc7\u63a5\u53e3\u7c7b\u578b\u548c\u540d\u5b57\u751f\u6210key\uff0c \u53bbMap \u91cc\u9762\u53bb\u627e\u5230\u5bf9\u5e94\u7684\u5b9e\u73b0\u7c7b\u7684\u5de5\u5382\u7c7b\uff0c \u518d\u8c03\u7528create \u65b9\u6cd5\u751f\u6210\u5bf9\u5e94\u7684\u5b9e\u73b0\u7c7b\u3002"),(0,l.kt)("h2",{id:"3-\u4f9d\u8d56\u6ce8\u5165\u5982\u4f55\u5b9e\u73b0"},"3. \u4f9d\u8d56\u6ce8\u5165\u5982\u4f55\u5b9e\u73b0"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'   public void testInjection() {\n    Container container = createFooContainer();\n    Foo foo = container.inject(Foo.class);\n  }\n  static class Foo {\n    @Inject Bar bar;\n    @Inject Bar copy;\n    @Inject("s") String s;\n    int i;\n    @Inject("i")\n    void setI(int i) {\n      this.i = i;\n    }\n  }\n  private Container createFooContainer() {\n    ContainerBuilder builder = new ContainerBuilder();\n    builder\n      .factory(Bar.class, BarImpl.class)\n      .factory(Tee.class, TeeImpl.class)\n      // \u6307\u5b9a\u5b57\u6bb5s,i \u6ce8\u5165\n      .constant("s", "test")\n      .constant("i", 5);\n\n    return builder.create(false);\n  }\n\n')),(0,l.kt)("p",null,"\u540d\u5b57\u53ebFoo\u7684\u7c7b\u91cc\u9762\u7684bar \u548ccopy \u548cs\uff0c \u8fd8\u6709\u5b57\u6bb5i\uff0c \u90fd\u662f\u4f7f\u7528\u4e86@Inject \u6ce8\u89e3\u7684\uff0c \u8bf4\u660e\u8fd9\u4e9b\u5b57\u6bb5\u90fd\u662f\u9700\u8981\u6ce8\u5165\u7684\u3002"),(0,l.kt)("h3",{id:"1\u9996\u5148\u521b\u5efa\u5bf9\u8c61"},"1.\t\u9996\u5148\u521b\u5efa\u5bf9\u8c61"),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},"Foo foo = container.inject(Foo.class);"),(0,l.kt)("p",{parentName:"li"},(0,l.kt)("img",{alt:"image-20220416145409582",src:n(6225).Z,width:"553",height:"217"})),(0,l.kt)("p",{parentName:"li"},"\u200b\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\u56fe12"))),(0,l.kt)("p",null,(0,l.kt)("img",{alt:"image-20220416145540216",src:n(8901).Z,width:"627",height:"401"})),(0,l.kt)("p",null,"\u200b\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\u56fe13"),(0,l.kt)("p",null,(0,l.kt)("img",{alt:"image-20220416150031356",src:n(6004).Z,width:"807",height:"219"})),(0,l.kt)("p",null,"\u200b\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\u56fe14"),(0,l.kt)("p",null,"\u6211\u4eec\u53d1\u73b0\uff0c \u6700\u540e\u5176\u5b9e\u5728\u8c03\u7528472\u884c\u4e2dinject \u65b9\u6cd5\u3002 \u7ee7\u7eeddebug \u770b\u770binject \u65b9\u6cd5\u5230\u5e95\u5728\u5e72\u4ec0\u4e48\u3002"),(0,l.kt)("p",null,(0,l.kt)("img",{alt:"image-20220416150225452",src:n(6066).Z,width:"837",height:"295"})),(0,l.kt)("p",null,"\u200b\t\t\t\t\t\t\t\t\t\t\t\t\t\u56fe15"),(0,l.kt)("p",null,"getConstructor(implementation) \uff0c \u62ff\u5230\u6784\u9020\u5668\u8c03\u7528construct \u521b\u5efa\u5bf9\u8c61\u3002 \u7ee7\u7eed\u5411\u4e0b\u9762\u770b"),(0,l.kt)("p",null,(0,l.kt)("img",{alt:"image-20220416150619122",src:n(6937).Z,width:"964",height:"818"})),(0,l.kt)("p",null,"\u200b\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\u56fe16(\u8bf7\u5ffd\u7565\u56fe\u91cc\u8bf4\u7684\u521b\u5efa\u4ee3\u7406\u5bf9\u8c61\uff0c\u8fd9\u662f\u521b\u5efa\u6784\u9020\u5668\u5bf9\u8c61)"),(0,l.kt)("p",null,"\u4e3aFoo\u521b\u5efa\u5bf9\u8c61\uff0c\u5e76\u4e14\u5c06\u521b\u5efa\u5bf9\u8c61\u8bbe\u7f6e\u5230\u4ee3\u7406\u4e2d\uff08\u8fd9\u91cc\u4ee3\u7406\u7528\u4e0d\u4e0a\uff0c\u540e\u9762\u5728\u89e3\u51b3\u5faa\u73af\u4f9d\u8d56\u7684\u65f6\u5019\u4f1a\u8bf4\uff09\uff0c\u5e76\u4e14\u62ff\u5230\u4e86\u8be5\u7c7b\u7684\u6ce8\u5165\u5668\u5bf9\u8c61injectors (\u5728373\u884c\uff09\uff0c \u8fd9\u4e2a\u6ce8\u5165\u5668\u5bf9\u8c61\u4ece\u54ea\u513f\u6765\u7684\uff1f \u4e3a\u4ec0\u4e48\u6211\u4eecdebug \u6ca1\u6709\u51fa\u6765\uff1f \u8fd9\u91cc\u5176\u5b9e\u5728"),(0,l.kt)("p",null,"\u56fe15\u7684433 \u884c\u4ee3\u7801\u4e2d\u7684  ",(0,l.kt)("inlineCode",{parentName:"p"},"ConstructorInjector constructor = getConstructor(implementation); "),"  \uff0c \u8c03\u7528\u7236\u7c7b\u7684\u5f02\u6b65\u65b9\u6cd5\u53bb\u83b7\u53d6\u6ce8\u5165\u5668\u3002 \u6846\u67b6\u91cc\u9762\u6709\u4e2a\u7c7b\u662f ReferenceCache\uff0c \u7528\u6765\u505a\u7f13\u5b58\u7684\uff0c \u91cc\u9762\u5f88\u591a\u7684\u5f02\u6b65\u64cd\u4f5c\u3002 \u4f46\u662f\u4eca\u5929\u6211\u4eec\u4e0d\u7814\u7a76\u8fd9\u4e2a\uff0c \u6240\u4ee5\u76f4\u63a5\u7565\u8fc7\u3002"),(0,l.kt)("p",null,(0,l.kt)("img",{alt:"image-20220416151157660",src:n(4125).Z,width:"819",height:"695"})),(0,l.kt)("p",null,"\u200b\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\u56fe17"),(0,l.kt)("h3",{id:"2\u6ce8\u5165\u5b57\u6bb5"},"2.\t\u6ce8\u5165\u5b57\u6bb5"),(0,l.kt)("p",null,"\u901a\u8fc7\u6784\u9020\u5668\u7684\u53bb\u62ff\u5230injects \u5bf9\u8c61\u96c6\u5408, \u521a\u597d\u662f4\u4e2a\uff0c \u56de\u60f3\u4e00\u4e0bFoo \u91cc\u9762\u7684\u5b57\u6bb5\u548c\u9759\u6001\u65b9\u6cd5\u4e5f\u662f4\u4e2a\u3002\u6211\u4eec\u7ee7\u7eed debug ",(0,l.kt)("inlineCode",{parentName:"p"}," injector.inject(context, t)")),(0,l.kt)("p",null,(0,l.kt)("img",{alt:"image-20220416152821637",src:n(9143).Z,width:"671",height:"479"})),(0,l.kt)("p",null,"\u200b\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\u56fe18"),(0,l.kt)("p",null,"\u5982\u56fe18 \u6240\u793a\uff0c \u901a\u8fc7\u53cd\u5c04\u5c06\u5b57\u6bb5\u6ce8\u5165\u8fdb\u53bb\u3002 \u8fd9\u5c31\u662f\u6846\u67b6\u6ce8\u5165\u7684\u6b65\u9aa4\u3002"),(0,l.kt)("h3",{id:"3\u5c0f\u7ed3"},"3.\t\u5c0f\u7ed3"),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},"\u521b\u5efa\u4ee3\u7406\u5bf9\u8c61"),(0,l.kt)("li",{parentName:"ol"},"\u901a\u8fc7@Inject \u83b7\u53d6\u6ce8\u5165\u5668\uff0c\u4f7f\u7528\u53cd\u5c04\u6ce8\u5165\u5bf9\u5e94\u7684\u5b57\u6bb5")),(0,l.kt)("h2",{id:"4-\u5904\u7406\u4f9d\u8d56\u5faa\u73af"},"4. \u5904\u7406\u4f9d\u8d56\u5faa\u73af"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},"  @Scoped(SINGLETON)\n  static class AImpl implements A {\n    final B b;\n    @Inject public AImpl(B b) {\n      this.b = b;\n    }\n    public B getB() {\n      return b;\n    }\n  }\n\n  interface B {\n    A getA();\n  }\n\n  static class BImpl implements B {\n    final A a;\n    @Inject public BImpl(A a) {\n      this.a = a;\n    }\n    public A getA() {\n      return a;\n    }\n  }\n")),(0,l.kt)("h4",{id:"1\u5148\u521b\u5efaaimpl\u7684\u6784\u9020\u5668"},"1.\t\u5148\u521b\u5efaAImpl\u7684\u6784\u9020\u5668"),(0,l.kt)("p",null,"AImpl \u548c BImpl \u76f8\u4e92\u4f9d\u8d56\uff0c\u5e76\u4e14AImpl\u662f\u5355\u4f8b\uff0c \u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c \u6846\u67b6\u662f\u5982\u4f55\u5904\u7406\u5faa\u73af\u4f9d\u8d56\u7684\u5462\u3002"),(0,l.kt)("p",null,(0,l.kt)("img",{alt:"image-20220416155136101",src:n(8833).Z,width:"1552",height:"587"})),(0,l.kt)("p",null,"\u200b\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\u56fe19"),(0,l.kt)("p",null,(0,l.kt)("img",{alt:"image-20220416155237541",src:n(9203).Z,width:"1161",height:"284"})),(0,l.kt)("p",null,"\u200b\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\u56fe20"),(0,l.kt)("h4",{id:"2\u5f53\u53d1\u73b0\u81ea\u5df1\u7684\u6784\u9020\u5668\u53c2\u6570\u91cc\u9762\u6709\u5176\u5b83\u53c2\u6570\u65f6\u5148\u521b\u5efa\u53c2\u6570\u5bf9\u8c61"},"2.\t\u5f53\u53d1\u73b0\u81ea\u5df1\u7684\u6784\u9020\u5668\u53c2\u6570\u91cc\u9762\u6709\u5176\u5b83\u53c2\u6570\u65f6\uff0c\u5148\u521b\u5efa\u53c2\u6570\u5bf9\u8c61"),(0,l.kt)("p",null,"\u5148Inject \u53c2\u6570B\uff0c\u76f8\u5f53\u4e8e\u521b\u5efaB"),(0,l.kt)("p",null,(0,l.kt)("img",{alt:"image-20220416155430941",src:n(6372).Z,width:"1620",height:"226"})),(0,l.kt)("p",null,(0,l.kt)("img",{alt:"image-20220416155548515",src:n(2956).Z,width:"1553",height:"890"})),(0,l.kt)("p",null,(0,l.kt)("img",{alt:"image-20220416155616081",src:n(5195).Z,width:"1643",height:"277"})),(0,l.kt)("p",null,"\u200b\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\u56fe21"),(0,l.kt)("p",null,"\u8fdb\u5165B\u7684\u53c2\u6570\u6784\u9020\u5668\uff0c \u8fd9\u4e2a\u65f6\u5019B\u7684\u6784\u9020\u5668\u53c2\u6570\u91cc\u9762\u9700\u8981AImpl\u7684\u5b9e\u4f8b\u5bf9\u8c61\uff0c"),(0,l.kt)("p",null,(0,l.kt)("img",{alt:"image-20220416155723093",src:n(4413).Z,width:"1409",height:"407"})),(0,l.kt)("p",null,"\u200b\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\u56fe22"),(0,l.kt)("p",null,"\u200b\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\u53c8\u53bb\u521b\u5efaAImpl\u7684\u5355\u4f8b\u5bf9\u8c61\u3002"),(0,l.kt)("p",null,(0,l.kt)("img",{alt:"image-20220416160838526",src:n(3509).Z,width:"1466",height:"204"})),(0,l.kt)("p",null,"\u200b\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\u56fe23"),(0,l.kt)("h4",{id:"3-\u53c2\u6570\u5bf9\u8c61\u521b\u5efa\u5b8c\u6210\u540e-\u518d\u521b\u5efaaimpl\u5b9e\u4f8b\u5bf9\u8c61\u540c\u65f6\u5c06\u6301\u6709aimpl\u7684\u4ee3\u7406\u5bf9\u8c61\u91cd\u65b0\u8bbe\u7f6e\u4e3a\u65b0\u7684aimpl\u7684\u5b9e\u4f8b\u5bf9\u8c61"},"3. \u53c2\u6570\u5bf9\u8c61\u521b\u5efa\u5b8c\u6210\u540e, \u518d\u521b\u5efaAImpl\u5b9e\u4f8b\u5bf9\u8c61\uff0c\u540c\u65f6\u5c06\u6301\u6709AImpl\u7684\u4ee3\u7406\u5bf9\u8c61\u91cd\u65b0\u8bbe\u7f6e\u4e3a\u65b0\u7684Aimpl\u7684\u5b9e\u4f8b\u5bf9\u8c61"),(0,l.kt)("p",null,"\u5224\u65adA\u7684\u6784\u9020\u5668\u5df2\u7ecf\u6784\u9020\u597d\u4e86\uff0c \u5c31\u4f1a\u4e3aB\u5bf9\u8c61\u7684AImpl\u521b\u5efa\u4ee3\u7406\u5bf9\u8c61\u3002 \u5c31\u662f\u4e0b\u9762\u7684\u65b9\u6cd5\u3002 \u8fd9\u4e2a\u65f6\u5019B\u6301\u6709\u7684\u5176\u5b9e\u662fAImpl\u7684\u4ee3\u7406\u5bf9\u8c61\u3002"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},"if (constructionContext.isConstructing()) {\n  // TODO (crazybob): if we can't proxy this object, can we proxy the\n  // other object?\n  return constructionContext.createProxy(expectedType);\n}\n\n")),(0,l.kt)("p",null,"\u56e0\u4e3a\u5728\u7b2c\u4e00\u6b21\u521b\u5efaAimpl\u7684\u65f6\u5019\uff0c\u5df2\u7ecf \u8d4b\u503c\u4e86 this.constructing = true\u3002 \u4e0b\u6b21\u5728\u521b\u5efa\u7684\u65f6\u5019\u5982\u679c\u662f\u5728\u4e00\u4e2a\u4e0a\u4e0b\u6587\u4e2d\u3002\u4e0b\u9762\u7684\u4ee3\u7801\u56fe21\u7684357 \u8c03\u7528\u7684\u3002"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},"  void startConstruction() {\n    this.constructing = true;\n  }\n")),(0,l.kt)("p",null,"\u73b0\u5728B\u7684Aimpl\u7684\u4ee3\u7406\u5bf9\u8c61\u521b\u5efa\u597d\u4e86\uff0cB\u7684\u5bf9\u8c61\u4e5f\u521b\u5efa\u597d\u4e86\u3002\u90a3\u4e48\u5c31\u8981\u7ee7\u7eed\u521b\u5efaAImpl\u7684\u5b9e\u4f8b\u5bf9\u8c61\u3002"),(0,l.kt)("p",null,(0,l.kt)("img",{alt:"image-20220416160217777",src:n(4188).Z,width:"1571",height:"704"})),(0,l.kt)("p",null,"\u200b\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\u56fe24"),(0,l.kt)("p",null,"\u521b\u5efa\u5b8cAImpl\u7684\u5bf9\u8c61\u4e4b\u540e\uff0c \u518d\u5c06AImpl\u7684\u771f\u5b9e\u5bf9\u8c61\uff0c B\u6301\u6709\u7684InvocationHanlder.setDelegate(\u771f\u5b9e\u5bf9\u8c61) \u5373\u53ef\u3002 \u662f\u4e0d\u662f\u5f88\u5999 \uff1f  \u54ce\uff0c \u4e0d\u5f97\u4e0d\u4f69\u670d\u5927\u795e\u57282006 \u5e74\u5c31\u80fd\u5199\u51fa\u8fd9\u79cd\u4ee3\u7801\uff0c \u592a\u5389\u5bb3\u5566\u3002  guice\u6846\u67b6\u91cc\u9762\u89e3\u51b3\u4f9d\u8d56\u5faa\u73af\u7684\u662f ConstructionContext \u8fd9\u4e2a\u7c7b\u3002\u5927\u5bb6\u6709\u65f6\u95f4\u53ef\u4ee5\u770b\u770b\u600e\u4e48\u89e3\u51b3\u7684\u3002 \u65e0\u8bbaAImpl\u91cc\u9762\u6709\u591a\u5c11\u4e2a\u6301\u6709A\u5bf9\u8c61\u5b9e\u4f8b\u7684\u5b57\u6bb5\uff0c \u53ea\u8981AImpl\u5b8c\u6210\u5b9e\u4f8b\u5bf9\u8c61\u521d\u59cb\u5316\u540e\uff0c \u518d\u8bbe\u7f6e\u7ed9\u6301\u6709AImpl\u5bf9\u8c61\u7684\u4ee3\u7406\u5c31\u53ef\u4ee5\u4e86\u3002"),(0,l.kt)("p",null,"\u4e0b\u9762\u518d\u770b\u770bConstructionContext \u7684\u90e8\u5206\u4ee3\u7801"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'Object createProxy(Class<? super T> expectedType) {\n    // TODO: if I create a proxy which implements all the interfaces of\n    // the implementation type, I\'ll be able to get away with one proxy\n    // instance (as opposed to one per caller).\n\n    if (!expectedType.isInterface()) {\n      throw new DependencyException(\n          expectedType.getName() + " is not an interface.");\n    }\n\n    if (invocationHandlers == null) {\n      invocationHandlers = new ArrayList<DelegatingInvocationHandler<T>>();\n    }\n\n    DelegatingInvocationHandler<T> invocationHandler =\n        new DelegatingInvocationHandler<T>();\n    invocationHandlers.add(invocationHandler);\n\n    return Proxy.newProxyInstance(\n      expectedType.getClassLoader(),\n      new Class[] { expectedType },\n      invocationHandler\n    );\n  }\n\n  void setProxyDelegates(T delegate) {\n    if (invocationHandlers != null) {\n      for (DelegatingInvocationHandler<T> invocationHandler\n          : invocationHandlers) {\n        invocationHandler.setDelegate(delegate);\n      }\n    }\n  }\n\n')),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"createProxy"),(0,l.kt)("p",{parentName:"li"},"\u521b\u5efa\u4ee3\u7406\u5bf9\u8c61\uff0c \u5f53\u521b\u5efaB\u5bf9\u8c61\u7684\u65f6\u5019\uff0c\u5728\u521b\u5efa\u6784\u9020\u5668\u7684\u65f6\u5019\u4f1a\u5148\u521b\u5efaAImpl\u5bf9\u8c61 \uff0c \u4f46\u662fAImpl\u5b9e\u4f8b\u6784\u9020\u5668\u5df2\u7ecf\u88ab\u6807\u8bb0\uff0c \u90a3\u5c31\u521b\u5efa\u4e00\u4e2a\u4ee3\u7406\u5bf9\u8c61\u3002")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"setProxyDelegates"),(0,l.kt)("p",{parentName:"li"},"\u5f53B\u7684\u5bf9\u8c61\u521b\u5efa\u5b8c\u6210\u540e\uff0c\u53c8\u8fd4\u56de\u5230AImpl\u521b\u5efa\u6784\u9020\u5668\u5bf9\u8c61\u4ee3\u7801\u7684\u5730\u65b9\uff0c\u7ee7\u7eed\u521b\u5efaAImpl\u5bf9\u8c61\u7684\u5b9e\u4f8b\uff0c \u518d\u8c03\u7528setProxyDelegates \u65b9\u6cd5\uff0c\u7ed9B\u6301\u6709\u7684Aimpl\u7684\u4ee3\u7406\u5bf9\u8c61\u4e2d\u7684delegate\u8bbe\u7f6e\u4e3aAImpl\u7684\u5b9e\u4f8b\u3002"))),(0,l.kt)("h4",{id:"4-\u5c0f\u7ed3"},"4. \u5c0f\u7ed3"),(0,l.kt)("p",null,"\u5728\u4e24\u4e2aA\uff0cB \u4e24\u4e2a\u5bf9\u8c61\u76f8\u4e92\u4f9d\u8d56\u7684\u65f6\u5019\uff0c \u9996\u5148\u521b\u5efaA\u7684\u6784\u9020\u5668\uff0c\u6807\u8bb0\u4e00\u4e0bA\u7684\u6784\u9020\u5668\u5df2\u7ecf\u521b\u5efa\uff0c\u5f53\u53d1\u73b0\u81ea\u5df1\u7684\u6784\u9020\u5668\u6709\u53c2\u6570B\u7684\u65f6\u5019\u5148\u53bb\u5e38\u89c1\u6784\u9020\u5668\u53c2\u6570B\uff0c\u5982\u679c\u6784\u9020\u5668\u4e2d\u53c2\u6570B\uff0c \u521b\u5efa\u5b9e\u4f8b\u5bf9\u8c61B\u7684\u65f6\u5019\u53d1\u73b0\u9700\u8981\u521b\u5efaA\u5bf9\u8c61\uff0c\u8fd9\u4e2a\u65f6\u5019A\u7684\u6784\u9020\u5668\u5df2\u7ecf\u6807\u8bb0\u521b\u5efa\u4e86\uff0c \u90a3\u4e48\u5c31\u7ed9B\u8bbe\u7f6e\u4e00\u4e2a\u4ee3\u7406\u5bf9\u8c61\u3002\u5f53B\u521b\u5efa\u5b8c\u6210\u540e\uff0c \u518d\u521b\u5efaA\u7684\u5b9e\u4f8b\u5bf9\u8c61\uff0c \u540c\u65f6\u518d\u5c06A\u7684\u5b9e\u4f8b\u5bf9\u8c61\u8bbe\u7f6e\u7ed9B\u7684\u6301\u6709\u7684A\u7c7b\u578b\u7684\u4ee3\u7406\u5bf9\u8c61\u3002 \u8fd9\u4e2a\u4e3b\u8981\u662f\u901a\u8fc7proxy \u53bb\u5b9e\u73b0\u7684\u3002 "),(0,l.kt)("h2",{id:"5-\u9759\u6001\u6ce8\u5165"},"5. \u9759\u6001\u6ce8\u5165"),(0,l.kt)("p",null,"  \u73b0\u5728\u6211\u4eec\u6765\u770b\u770b\u9759\u6001\u6ce8\u5165\u662f\u5982\u4f55\u5b9e\u73b0\u7684\u3002"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-java"},'public class StaticInjectionTest extends TestCase {\n\n  public void testInjectStatics() {\n    Container c = new ContainerBuilder()\n        .constant("s", "test")\n        .constant("i", 5)\n        .injectStatics(StaticInjectionTest.Static.class)\n        .create(false);\n    assertEquals("test", StaticInjectionTest.Static.s);\n    assertEquals(5, StaticInjectionTest.Static.i);\n  }\n\n  static class Static {\n    @Inject("i") static int i;\n    static String s;\n    @Inject("s") static void setS(String s) {\n      StaticInjectionTest.Static.s = s;\n    }\n  }\n')),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},"\u76f4\u63a5\u770b ",(0,l.kt)("inlineCode",{parentName:"p"},"injectStatics")," \u65b9\u6cd5\u8c03\u7528\uff0c\u9996\u5148\u5c06\u9700\u8981\u6ce8\u5165\u7684\u9759\u6001\u7c7b\u8bbe\u7f6e\u52a0\u5165\u96c6\u5408\u3002"),(0,l.kt)("p",{parentName:"li"},"injectStatics(StaticInjectionTest.Static.class)"),(0,l.kt)("p",{parentName:"li"},(0,l.kt)("img",{alt:"image-20220416163728265",src:n(5059).Z,width:"798",height:"170"}))),(0,l.kt)("li",{parentName:"ol"},(0,l.kt)("p",{parentName:"li"},"\u5728\u56fe5\u7684\u65f6\u5019\uff0c \u6211\u4eec\u5df2\u7ecf\u77e5\u9053\u5728\u521b\u5efa\u5bb9\u5668\u65f6\u4f1a\u6267\u884c\u9759\u6001\u6ce8\u5165\u3002\u5982\u4e0b\u56fe\u6240\u793a"))),(0,l.kt)("p",null,(0,l.kt)("img",{alt:"image-20220416163912290",src:n(6504).Z,width:"993",height:"412"})),(0,l.kt)("p",null,"\u200b\t\t\u6211\u4eec\u7ee7\u7eed\u770b\u6267\u884c\u9759\u6001\u6ce8\u5165\u7684\u5177\u4f53\u6d41\u7a0b\uff0c \u7ee7\u7eeddebug  ",(0,l.kt)("inlineCode",{parentName:"p"},"container.injectStatics(staticInjections)")),(0,l.kt)("p",null,(0,l.kt)("img",{alt:"image-20220416164023068",src:n(6460).Z,width:"723",height:"434"})),(0,l.kt)("p",null,"\u200b\t\t\t\t\t\t\t\t\t\t\t\u4e0b\u9762\u7ee7\u7eed\u770baddInjectorsForMembers \u65b9\u6cd5\u505a\u4e86\u4ec0\u4e48\uff1f"),(0,l.kt)("p",null,(0,l.kt)("img",{alt:"image-20220416164306372",src:n(8989).Z,width:"1010",height:"398"})),(0,l.kt)("p",null,"\u4e3b\u8981\u662f\u8fd9\u4e00\u6bb5\u4ee3\u7801\uff0c",(0,l.kt)("inlineCode",{parentName:"p"},"\t\t\t\t\t\tinjectors.add(injectorFactory.create(this, member, inject.value()));")),(0,l.kt)("p",null,"\u8fc7\u6ee4\u9759\u6001\u5b57\u6bb5(inject.value() \u662f\u5b57\u6bb5\u7684\u540d\u5b57\uff0c), injector \u5de5\u5382\u751f\u6210\u4e86injector\u3002\u8fd9\u91cc\u7684\u9759\u6001\u65b9\u6cd5\u540c\u7406\uff0c\u6240\u4ee5\u4e0d\u622a\u56fe\u4e86\u3002"),(0,l.kt)("p",null,(0,l.kt)("img",{alt:"image-20220416165057283",src:n(4542).Z,width:"849",height:"456"})),(0,l.kt)("p",null,"\u200b\t\t\t\t\t\u62ff\u5230\u4e86\u6ce8\u5165\u5668\u540e\uff0c\u5206\u522b\u6267\u884cMethodInject\u548cFieldInject\u7684inject \u65b9\u6cd5\uff0c\u4e0b\u9762\u5c31\u4e0d\u7528\u7ec6\u8bf4\u4e86\uff0c\u80cc\u540e\u7684\u539f\u7406\u5c31\u662f\u4f7f\u7528\u53cd\u5c04\u7684\u65b9\u5f0f\u7ed9\u5b57\u6bb5\u8bbe\u7f6e\u503c\uff0c \u8c03\u7528\u9759\u6001\u65b9\u6cd5\u8bbe\u7f6e\u503c\u3002"),(0,l.kt)("h2",{id:"6-guice-\u548cspring-\u4f7f\u7528di-\u548cioc-\u901f\u5ea6\u5bf9\u6bd4"},"6. guice \u548cspring \u4f7f\u7528DI \u548cIOC \u901f\u5ea6\u5bf9\u6bd4"),(0,l.kt)("p",null,"\u5728java \u7684\u751f\u6001\u4e2d\u6709\u4e00\u9053\u6c38\u8fdc\u8fc8\u4e0d\u8fc7\u7684\u5929\u82b1\u677f\uff0c\u90a3\u5c31\u662fspring\u3002 \u6240\u4ee5guice \u60f3\u548cspring \u4e00\u8f83\u9ad8\u4e0b\u3002 guice \u5904\u7406bean\u7684\u901f\u5ea6\u5927\u7ea6\u662fspring\u768440\u500d\u3002\u8fd9\u4e2a\u6d4b\u8bd5\u7c7b\u7684\u540d\u5b57\u662f  ",(0,l.kt)("inlineCode",{parentName:"p"},"com.google.inject.SpringTest"),"  \u6240\u6709\u5c0f\u4f19\u4f34\u4eec\u5728\u4f7f\u7528storm \u6216\u8005flink \u4e4b\u7c7b\u7684\u6846\u67b6\u7684\u65f6\u5019\uff0c\u8be5\u9009\u62e9guice \u5c31\u8981\u9009\u62e9juice \u3002 "),(0,l.kt)("h2",{id:"7-\u603b\u7ed3"},"7. \u603b\u7ed3"),(0,l.kt)("p",null,"\u901a\u8fc7\u672c\u7bc7\u6587\u7ae0\u6211\u4eec\u80fd\u591f\u5b66\u4e60\u5230"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"bean \u7684\u521b\u5efa\u548c\u7ba1\u7406\uff08IOC)"),(0,l.kt)("li",{parentName:"ul"},"\u4f9d\u8d56\u6ce8\u5165\uff08DI\uff09\u662f\u5982\u4f55\u5b9e\u73b0\u7684"),(0,l.kt)("li",{parentName:"ul"},"\u5982\u4f55\u5904\u7406\u4f9d\u8d56\u5faa\u73af"),(0,l.kt)("li",{parentName:"ul"},"\u9759\u6001\u6ce8\u5165\u5982\u4f55\u5b9e\u73b0")),(0,l.kt)("p",null,"\u200b\t\t\t\u672c\u7bc7\u6587\u7ae0\u53ea\u662f\u5206\u6790\u4e86\u90e8\u5206\u529f\u80fd\u7684\u539f\u7406\uff0c\u8fd9\u53ea\u662f\u6211\u4eec\u5b66\u4e60\u7684\u4e00\u5c0f\u6b65\uff0c\u540e\u9762\u5982\u679c\u53ef\u80fd\u7684\u8bdd\uff0c\u6211\u5c06\u5206\u6790guice \u8bbe\u8ba1\u65b9\u6cd5\u7684\u4e1c\u897f\u3002"))}g.isMDXComponent=!0},890:function(t,e,n){e.Z=n.p+"assets/images/image-20220416135734557-a8603f88b6a3b4df5a57b5b82c203523.png"},8421:function(t,e,n){e.Z=n.p+"assets/images/image-20220416135800301-ff1beae098f05d172336842e4587ec95.png"},430:function(t,e,n){e.Z=n.p+"assets/images/image-20220416135815906-d6031973bdaadb15738008745097cc5b.png"},1688:function(t,e,n){e.Z=n.p+"assets/images/image-20220416140009260-3e98542731f7544e9f2689d64362329b.png"},6879:function(t,e,n){e.Z=n.p+"assets/images/image-20220416140517464-52ea682564c80056cc09af84ed975889.png"},1679:function(t,e,n){e.Z=n.p+"assets/images/image-20220416140847252-5bf495580dd16f62f196f6c4d524bb06.png"},902:function(t,e,n){e.Z=n.p+"assets/images/image-20220416140923405-34d1b5451651b12539590b5f5cc6004a.png"},8501:function(t,e,n){e.Z=n.p+"assets/images/image-20220416142457081-f9d5dcafdf6a5175183a3ef193f114e2.png"},6755:function(t,e,n){e.Z=n.p+"assets/images/image-20220416143220942-78b941a282a49a7b18490ac8347ae393.png"},7455:function(t,e,n){e.Z=n.p+"assets/images/image-20220416143523366-cd391b7ddfbec393971b8454d831eebc.png"},2756:function(t,e,n){e.Z=n.p+"assets/images/image-20220416143746681-f5c2536580446dfd74767d8d2008c6ca.png"},6225:function(t,e,n){e.Z=n.p+"assets/images/image-20220416145409582-6539ee11d5fd87128d7488a10fddf06d.png"},8901:function(t,e,n){e.Z=n.p+"assets/images/image-20220416145540216-4b555a60a75d70b291bb97b6477ba58a.png"},6004:function(t,e,n){e.Z=n.p+"assets/images/image-20220416150031356-7f7deaed1909e263e76d93f5e338dff2.png"},6066:function(t,e,n){e.Z=n.p+"assets/images/image-20220416150225452-3face804fcda338b5d7c2416f349427e.png"},6937:function(t,e,n){e.Z=n.p+"assets/images/image-20220416150619122-02f1b39ed003d2a32c67c110fcfbb50d.png"},4125:function(t,e,n){e.Z=n.p+"assets/images/image-20220416151157660-cc758dc8e12e3213a29478e49914e450.png"},9143:function(t,e,n){e.Z=n.p+"assets/images/image-20220416152821637-5f79230262b70050b77e68ced0c0ef0e.png"},8833:function(t,e,n){e.Z=n.p+"assets/images/image-20220416155136101-958b8f7cd0f3cec43e30fed071b6f168.png"},9203:function(t,e,n){e.Z=n.p+"assets/images/image-20220416155237541-b5435c44c72b355d9a0896668b9f4e29.png"},6372:function(t,e,n){e.Z=n.p+"assets/images/image-20220416155430941-be102310320749c973712f5db41beb4a.png"},2956:function(t,e,n){e.Z=n.p+"assets/images/image-20220416155548515-df20c1aecfa29ad92ce68981dc0204e5.png"},5195:function(t,e,n){e.Z=n.p+"assets/images/image-20220416155616081-d5b75fa91df8107be933da29cc1043eb.png"},4413:function(t,e,n){e.Z=n.p+"assets/images/image-20220416155723093-7f8bc7320e5560e8407d54d70aceb7de.png"},4188:function(t,e,n){e.Z=n.p+"assets/images/image-20220416160217777-a0cb8909d77f2bb119834a173393a4f8.png"},3509:function(t,e,n){e.Z=n.p+"assets/images/image-20220416160838526-9288d3737dae8afa2d2834b3996c86f5.png"},5059:function(t,e,n){e.Z=n.p+"assets/images/image-20220416163728265-a1e4081b543b1adb34bf1055d334ccd0.png"},6504:function(t,e,n){e.Z=n.p+"assets/images/image-20220416163912290-0033ab33d5870b7ad2c9930b5a6c6426.png"},6460:function(t,e,n){e.Z=n.p+"assets/images/image-20220416164023068-eca0ed16528a2336b7dc928fb78167b2.png"},8989:function(t,e,n){e.Z=n.p+"assets/images/image-20220416164306372-2923cf857da924a2ec50cf229bd5dbe0.png"},4542:function(t,e,n){e.Z=n.p+"assets/images/image-20220416165057283-295d2cb483e9cdbe9434488634a6103b.png"}}]);