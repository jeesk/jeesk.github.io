<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.15">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="山间草夫的小站 RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="山间草夫的小站 Atom Feed">
<link rel="alternate" type="application/rss+xml" href="/java/rss.xml" title="山间草夫的小站 RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/java/atom.xml" title="山间草夫的小站 Atom Feed">
<link rel="alternate" type="application/rss+xml" href="/database/rss.xml" title="山间草夫的小站 RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/database/atom.xml" title="山间草夫的小站 Atom Feed">
<link rel="alternate" type="application/rss+xml" href="/microservice/rss.xml" title="山间草夫的小站 RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/microservice/atom.xml" title="山间草夫的小站 Atom Feed">
<link rel="alternate" type="application/rss+xml" href="/data-structure-and-algorithm/rss.xml" title="山间草夫的小站 RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/data-structure-and-algorithm/atom.xml" title="山间草夫的小站 Atom Feed">
<link rel="alternate" type="application/rss+xml" href="/devops/rss.xml" title="山间草夫的小站 RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/devops/atom.xml" title="山间草夫的小站 Atom Feed"><title data-react-helmet="true">spring容器相关阅读 | 山间草夫的小站</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://shanjiancaofu.com/docs/spring/spring-container"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="spring容器相关阅读 | 山间草夫的小站"><meta data-react-helmet="true" name="description" content="本文基于spring 1.0 版本分析。我们将学习所有继承spring 容器的相关类。因为容器的类错综复杂， 要搞清关系，首先要找出beanFactory  比较底层的子类，就是beanFacotry的实现类，然后通过继承图分析该类的功能和使用方法。我们每次学习一个类，学习的步骤如下"><meta data-react-helmet="true" property="og:description" content="本文基于spring 1.0 版本分析。我们将学习所有继承spring 容器的相关类。因为容器的类错综复杂， 要搞清关系，首先要找出beanFactory  比较底层的子类，就是beanFacotry的实现类，然后通过继承图分析该类的功能和使用方法。我们每次学习一个类，学习的步骤如下"><link data-react-helmet="true" rel="icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://shanjiancaofu.com/docs/spring/spring-container"><link data-react-helmet="true" rel="alternate" href="https://shanjiancaofu.com/docs/spring/spring-container" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://shanjiancaofu.com/docs/spring/spring-container" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.7ec3e632.css">
<link rel="preload" href="/assets/js/runtime~main.d6c809c7.js" as="script">
<link rel="preload" href="/assets/js/main.0c9f8076.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/avtor.png" alt="My Site Logo" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/img/avtor.png" alt="My Site Logo" class="themedImage_W2Cr themedImage--dark_oUvU"></div><b class="navbar__title">山间草夫</b></a><a class="navbar__item navbar__link navbar__link--active" href="/docs/intro">源码分析</a><a class="navbar__item navbar__link" href="/java">Java</a><a class="navbar__item navbar__link" href="/devops">Devops</a><a class="navbar__item navbar__link" href="/data-structure-and-algorithm">数据结构与算法</a><a class="navbar__item navbar__link" href="/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/jeesk" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_Pssr toggle_TdHA toggleDisabled_jDku"><div class="toggleTrack_SSoT" role="button" tabindex="-1"><div class="toggleTrackCheck_XobZ"><span class="toggleIcon_eZtF">🌜</span></div><div class="toggleTrackX_YkSC"><span class="toggleIcon_eZtF">🌞</span></div><div class="toggleTrackThumb_uRm4"></div></div><input type="checkbox" class="toggleScreenReader_JnkT" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_P2Lg"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_RiI4" type="button"></button><aside class="theme-doc-sidebar-container docSidebarContainer_rKC_"><div class="sidebar_gi4H"><nav class="menu thin-scrollbar menu_PfFV"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/intro">阅读说明</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_VCh3" href="/docs/google-guice/google-guice-source">google-guice</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active hasHref_VCh3" aria-current="page" href="/docs/spring/spring-container">spring</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/spring/spring-container">spring容器相关阅读</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/api/docusaurus-config">docusaurus.config.js</a></li></ul></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_FGfn"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_tdHK"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></aside><main class="docMainContainer_TCnq"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_DM6M"><div class="docItemContainer_vinB"><article><div class="tocCollapsible_jdIR theme-doc-toc-mobile tocMobile_TmEX"><button type="button" class="clean-btn tocCollapsibleButton_Fzxq">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>spring容器相关阅读</h1></header><blockquote><p>本文基于spring 1.0 版本分析。我们将学习所有继承spring 容器的相关类。因为容器的类错综复杂， 要搞清关系，首先要找出beanFactory  比较底层的子类，就是beanFacotry的实现类，然后通过继承图分析该类的功能和使用方法。我们每次学习一个类，学习的步骤如下</p><ol><li>分析底层容器的继承</li><li>代码实战</li><li>分析spring 容器api的具体实现。</li><li>小结</li></ol><p>​    通过循序渐进的学习，大家会发现spring 也是很简单的东西， 一起来吧。</p></blockquote><h2 class="anchor anchorWithStickyNavbar_mojV" id="一-staticlistablebeanfactory">一. StaticListableBeanFactory<a class="hash-link" href="#一-staticlistablebeanfactory" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_mojV" id="1继承分析">1.	继承分析<a class="hash-link" href="#1继承分析" title="Direct link to heading">​</a></h3><p>​																									继承图如下</p><p><img alt="image-20220422185153493" src="/assets/images/image-20220422185153493-480e1aacf54fe34f43339763e9a64e88.png" width="294" height="239"></p><p>该类主要是提供允许以编程方式注册现有单例实例， 这个类的static 可以忽略。 </p><h4 class="anchor anchorWithStickyNavbar_mojV" id="1-beanfactory">1. BeanFactory<a class="hash-link" href="#1-beanfactory" title="Direct link to heading">​</a></h4><p>这个类不实详细说了， 是spring的顶级容器接口。下面是接口的方法，考虑到能学习spring 源码的人肯定会用到这几个接口，这里就不细说了。</p><p>​				<img alt="image-20220422191350929" src="data:image/png;base64,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" width="336" height="121"></p><h4 class="anchor anchorWithStickyNavbar_mojV" id="2-listablebeanfactory">2. ListableBeanFactory<a class="hash-link" href="#2-listablebeanfactory" title="Direct link to heading">​</a></h4><p>由于一个实现可以由多个工厂BeanFactory实现(拥有多种创建方式），这个主要提供一个实例的的所有工厂类。 下面是有关ListableBeanFactory的接口方法。</p><ul><li><p><code>getBeanDefinitionCount()  </code>         返回容器里面存在的bean的数量。不考虑使用层次工厂所创建的类。层次工厂是一种创建bean 的方式，为什么不会考虑使用层次工厂创建的类，后面会详细的说。</p></li><li><p><code>getBeanDefinitionNames() </code>        返回此工厂中定义的所有 bean 的名称。不考虑使用层次工厂所创建的类。</p></li><li><p><code>getBeanDefinitionNames(Class type)</code>       使用Class类型过滤，然后返回匹配给定类型（包括子类）的 bean 的名称。 不考虑使用层次工厂所创建的类。</p></li><li><p><code>containsBeanDefinition(String name)</code>        通过bean的名字判断，容器里面是否包含某个bean </p></li><li><p><code>Map getBeansOfType(Class type, boolean includePrototypes, boolean includeFactoryBeans)
	    throws BeansException </code></p><p>第一个class指定了Class精英，通过Class类型获取Bean，第二个参数: 是否也包含原型 bean 或仅包含单例（也适用于 FactoryBeans）, 第三个参数表示是否包含工厂bean。 </p></li></ul><h4 class="anchor anchorWithStickyNavbar_mojV" id="3---staticlistablebeanfactory">3.   StaticListableBeanFactory<a class="hash-link" href="#3---staticlistablebeanfactory" title="Direct link to heading">​</a></h4><p><code>public void addBean(String name, Object bean) </code>  StaticListableBeanFactory 里面增加bean的一种方法。 </p><p>通过继承分析， 我们大概知道了StaticListableBeanFactory的具体功能。 </p><h3 class="anchor anchorWithStickyNavbar_mojV" id="2-代码实战">2. 代码实战<a class="hash-link" href="#2-代码实战" title="Direct link to heading">​</a></h3><p>既然我们已经知道了StaticLisable的功能，下面写写代码玩一玩。 现在我们假设有个学生和人物的对象，我们将这两个bean放入容器试一试相关api 功能。  在看代码的时候，记得思考一下答案。 </p><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx java"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain"> public void testStaticListableBeanFactory() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Person person1 = new Person(&quot;person1&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Person person2 = new Person(&quot;person2&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Student student1 = new Student(&quot;student1&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Student student2 = new Student(&quot;student2&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        StaticListableBeanFactory slb = new StaticListableBeanFactory();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        slb.addBean(&quot;person1&quot;, person1);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        slb.addBean(&quot;person2&quot;, person2);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        slb.addBean(&quot;student1&quot;, student1);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        slb.addBean(&quot;student2&quot;, student2);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 1. 首先试一试 BeanFactory 里面的功能</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println(((Person) (slb.getBean(&quot;person1&quot;))).name);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println(((Person) slb.getBean(&quot;person2&quot;, Person.class)).name);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println(&quot;容器里面是否包含person1对象:&quot; + slb.containsBean(&quot;person1&quot;));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println(&quot;person1是否是单例对象:&quot; + slb.isSingleton(&quot;person1&quot;));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 2. 试一试 ListableBeanFactory 的功能</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println(&quot;bean 定义的数量：&quot; + slb.getBeanDefinitionCount());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println(&quot;该容器中所有bean的：&quot; + Arrays.toString(slb.getBeanDefinitionNames()));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 这个方法功能不就是和 BeanFactory.containsBean一样吗？</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println(&quot;容器是否包含Person：&quot; + slb.containsBeanDefinition(&quot;person1&quot;));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // 查找所有的Person类型</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Map&lt;String, Object&gt; beansOfType = slb.getBeansOfType(Person.class, false, false);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        for (Map.Entry&lt;String, Object&gt; se : beansOfType.entrySet()) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            System.out.println(se.getKey() + &quot;:&quot; + ((Person) se.getValue()).name);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>控制台打印如下：</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">person1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">person2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">容器里面是否包含person1对象:true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">person1是否是单例对象:true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">bean 定义的数量：4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">该容器中所有bean的：[Ljava.lang.String;@7e0b37bc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">容器是否包含Person：true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">person2:person2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">person1:person1</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="3-源码分析">3. 源码分析<a class="hash-link" href="#3-源码分析" title="Direct link to heading">​</a></h3><p> 通过在前面的分析，大概可以猜想出StaticListableBeanFactory 里面在执行add() 方法的时候保存了bean和Type的映射关系。</p><p><img alt="image-20220422194510480" src="/assets/images/image-20220422194510480-d88656a84174d19deffc7bb0c27dd4e8.png" width="981" height="296"></p><h4 class="anchor anchorWithStickyNavbar_mojV" id="31addbeanstring-name-object-bean">3.1	addBean(String name, Object bean)<a class="hash-link" href="#31addbeanstring-name-object-bean" title="Direct link to heading">​</a></h4><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx java"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">    public void addBean(String name, Object bean) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        this.beans.put(name, bean);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>该方法非常简单，直接将bean的名字作为key，实例对象作为value 放入了map里面去</p><h4 class="anchor anchorWithStickyNavbar_mojV" id="32--public-object-getbeanstring-name">3.2  public Object getBean(String name)<a class="hash-link" href="#32--public-object-getbeanstring-name" title="Direct link to heading">​</a></h4><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx java"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">    @Override</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public Object getBean(String name) throws BeansException {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Object bean = this.beans.get(name);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (bean instanceof FactoryBean) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                return ((FactoryBean) bean).getObject();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            } catch (Exception ex) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                throw new BeanCreationException(&quot;FactoryBean threw exception on object creation&quot;, ex);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (bean == null)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            throw new NoSuchBeanDefinitionException(name, &quot;defined beans are [&quot; +</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    StringUtils.collectionToCommaDelimitedString(this.beans.keySet()) + &quot;]&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return bean;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>首先通过实例对象的名字去map里面查找bean， 并且判断bean是否是FactoryBean ，FactoryBean是一个可以获取bean对象的bean，是一个实例，假如是FactoryBean 通过getObject() 方法获取实例对象即可, 并且通过该接口可以判断是否是单例bean。如果bean 等于空将会抛出异常，否则直接将bean 返回。</p><h4 class="anchor anchorWithStickyNavbar_mojV" id="33public-object-getbeanstring-name-class-requiredtype">3.3	public Object getBean(String name, Class requiredType)<a class="hash-link" href="#33public-object-getbeanstring-name-class-requiredtype" title="Direct link to heading">​</a></h4><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx java"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">    @Override</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public Object getBean(String name, Class requiredType) throws BeansException {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Object bean = getBean(name);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (!requiredType.isAssignableFrom(bean.getClass())) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            throw new BeanNotOfRequiredTypeException(name, requiredType, bean);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return bean;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>通过名字查找bean， 再通过requiredType判断bean的接口是否是requiredType， 或者bean的类型是否是requiredType类型。 因为spring 的名字不能重复， 代码比Google juice 简单多了。 </p><h4 class="anchor anchorWithStickyNavbar_mojV" id="34--public-boolean-containsbeanstring-name">3.4  public boolean containsBean(String name)<a class="hash-link" href="#34--public-boolean-containsbeanstring-name" title="Direct link to heading">​</a></h4><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx java"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">    @Override</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public boolean containsBean(String name) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return this.beans.containsKey(name);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>不解释，相信都能看懂</p><h4 class="anchor anchorWithStickyNavbar_mojV" id="35-public-boolean-issingletonstring-name">3.5 public boolean isSingleton(String name)<a class="hash-link" href="#35-public-boolean-issingletonstring-name" title="Direct link to heading">​</a></h4><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx java"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">    @Override</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public boolean isSingleton(String name) throws NoSuchBeanDefinitionException {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Object bean = getBean(name);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // in case of FactoryBean, return singleton status of created object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if (bean instanceof FactoryBean) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return ((FactoryBean) bean).isSingleton();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        } else {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return true;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>如果不是beanfactory 肯定是单例，因为spring 名字不能重复。 如果是FactoryBean 的实现类的话，那么就需要使用 <code>isSingleton() 方法</code> 判断。 </p><h4 class="anchor anchorWithStickyNavbar_mojV" id="36-public-int-getbeandefinitioncount">3.6 public int getBeanDefinitionCount()<a class="hash-link" href="#36-public-int-getbeandefinitioncount" title="Direct link to heading">​</a></h4><p>这个方法不用解释了吧？ 就是返回容器里面bean的数量</p><h4 class="anchor anchorWithStickyNavbar_mojV" id="37-public-string-getbeandefinitionnames">3.7 public String[] getBeanDefinitionNames()<a class="hash-link" href="#37-public-string-getbeandefinitionnames" title="Direct link to heading">​</a></h4><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx java"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">    @Override</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public String[] getBeanDefinitionNames() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return (String[]) this.beans.keySet().toArray(new String[this.beans.keySet().size()]);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>将map对象的所有的key作为返回</p><h4 class="anchor anchorWithStickyNavbar_mojV" id="38-getbeandefinitionnames">3.8 getBeanDefinitionNames<a class="hash-link" href="#38-getbeandefinitionnames" title="Direct link to heading">​</a></h4><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx java"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">    @Override</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public String[] getBeanDefinitionNames(Class type) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        List matches = new LinkedList();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Set keys = this.beans.keySet();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Iterator itr = keys.iterator();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        while (itr.hasNext()) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            String name = (String) itr.next();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Class clazz = this.beans.get(name).getClass();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            if (type.isAssignableFrom(clazz)) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                matches.add(name);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return (String[]) matches.toArray(new String[matches.size()]);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>指定一个type类型，然后遍历容器里面的所有的bean， 如果bean的接口是type类型或者，bean的类型就是type类型，将bean加入到list 里面，最后返回。 </p><h4 class="anchor anchorWithStickyNavbar_mojV" id="39-public-map-getbeansoftypeclass-type-boolean-includeprototypes-boolean-includefactorybeans">3.9 public Map getBeansOfType(Class type, boolean includePrototypes, boolean includeFactoryBeans)<a class="hash-link" href="#39-public-map-getbeansoftypeclass-type-boolean-includeprototypes-boolean-includefactorybeans" title="Direct link to heading">​</a></h4><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx java"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">    public Map getBeansOfType(Class type, boolean includePrototypes, boolean includeFactoryBeans) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Map matches = new HashMap();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Set keys = this.beans.keySet();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Iterator itr = keys.iterator();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        while (itr.hasNext()) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            String name = (String) itr.next();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Object bean = this.beans.get(name);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            // 判断要查找的bean是否是factoryBean</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            if (bean instanceof FactoryBean &amp;&amp; includeFactoryBeans) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                FactoryBean factory = (FactoryBean) bean;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Class objectType = factory.getObjectType();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                // 这里的getObjectType 要说明一下， 单例bean 如何通过FactoryBean 创建他的类型可能是空，所以这里判断是objectType == null</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                if ((objectType == null &amp;&amp; factory.isSingleton()) ||  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    // includePrototypes 表示该类是实例类型的原型类（比如A extend B ,这里要查找A类型对象，includePrototypes 表示type就是A.class,而不是B.class,  includePrototypes 和下面的</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        ((factory.isSingleton() || includePrototypes) &amp;&amp; type.isAssignableFrom(objectType)) 是等价的。 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                         // 这里表示FactoryBean 返回的对象类型就是我们要查找的对象类型，满足条件。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                objectType != null &amp;&amp; type.isAssignableFrom(objectType))) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    Object createdObject = getBean(name);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    if (type.isInstance(createdObject)) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        matches.put(name, createdObject);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            } else if (type.isAssignableFrom(bean.getClass())) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                matches.put(name, bean);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return matches;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="3-小结">3. 小结<a class="hash-link" href="#3-小结" title="Direct link to heading">​</a></h3><p>​			我们可以知道StaticLisableBeanFactory 就是实现了BeanFactory，和ListableBeanFactory， 新增了添加Bean 的方法，和static 没有关系。 这是个历史遗留问题, 大家记得关注重点唷。 </p><h2 class="anchor anchorWithStickyNavbar_mojV" id="二-xmlbeanfactory">二. XmlBeanFactory<a class="hash-link" href="#二-xmlbeanfactory" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_mojV" id="1-继承分析">1. 继承分析<a class="hash-link" href="#1-继承分析" title="Direct link to heading">​</a></h3><p><img alt="image-20220422202339905" src="/assets/images/image-20220422202339905-d8fa72b8faebf8cfbab4128e50b326f7.png" width="969" height="572"></p><h4 class="anchor anchorWithStickyNavbar_mojV" id="1hierarchicalbeanfactory">1.	HierarchicalBeanFactory<a class="hash-link" href="#1hierarchicalbeanfactory" title="Direct link to heading">​</a></h4><ul><li><code>BeanFactory getParentBeanFactory</code>   该接口类只有一个方法， 就是获取父亲工厂。</li></ul><p>层次BeanFactory， 这个是什么意思？ 在spring 处理依赖的时候比如 A和B 两个实例对象， 下面有两种处理的方法</p><ol><li><p>直接将A和B的实例对象增加到同一个容器里面。</p></li><li><p>A和B 的实例对象不在一个容器里面。</p><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx java"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">        XmlBeanFactory xbf = new XmlBeanFactory(new ClassPathResource(&quot;autowire.xml&quot;, getClass()));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        DefaultListableBeanFactory lbf = new DefaultListableBeanFactory();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        MutablePropertyValues pvs = new MutablePropertyValues();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        pvs.addPropertyValue(&quot;name&quot;, &quot;kerry&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        lbf.registerBeanDefinition(&quot;spouse&quot;, new RootBeanDefinition(TestBean.class, pvs));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        xbf.setParentBeanFactory(lbf);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        DependenciesBean rod1 = (DependenciesBean) xbf.getBean(&quot;rod1&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        TestBean kerry = (TestBean) xbf.getBean(&quot;spouse&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Should have been autowired</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        assertEquals(kerry, rod1.getSpouse());</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>​		DependenciesBean 类型里面依赖TestBean ， 但是我们不直接创建TestBean的对象，而是将TestBean封装成BeanDefinition，然后注册到Bean工厂。 然后将Bean工厂作为被依赖类的父类工厂， 也就是说如果当前容器找不到实例对象， 需要去从父类里面找。 </p></li></ol><p>​			总之一句话 HierarchicalBeanFactory 就是将Bean 放在不同的容器里面，如果在当前容器找不到就去parent容器里面查找。 既然有获取父类工厂就没有设置父类工厂的功能， 那么就是下面 ConfigurableBeanFactory 接口， 并且ConfigurableBeanFactory  也继承了HierarchicalBeanFactory .  这两个类要一直记一下主要是实现了parentBeanFactory的功能。 </p><h4 class="anchor anchorWithStickyNavbar_mojV" id="2--configurablebeanfactory">2.  	ConfigurableBeanFactory<a class="hash-link" href="#2--configurablebeanfactory" title="Direct link to heading">​</a></h4><p>​			名字翻译过来就是可配置的工厂， 这个工厂很一些需要的功能，下面来看看到底有哪些功能？ </p><h5 class="anchor anchorWithStickyNavbar_mojV" id="1setparentbeanfactorybeanfactory-parentbeanfactory">1.	setParentBeanFactory(BeanFactory parentBeanFactory);<a class="hash-link" href="#1setparentbeanfactorybeanfactory-parentbeanfactory" title="Direct link to heading">​</a></h5><p>​		设置父类bean工厂</p><h5 class="anchor anchorWithStickyNavbar_mojV" id="2registercustomeditorclass-requiredtype-propertyeditor-propertyeditor">2.	registerCustomEditor(Class requiredType, PropertyEditor propertyEditor)<a class="hash-link" href="#2registercustomeditorclass-requiredtype-propertyeditor-propertyeditor" title="Direct link to heading">​</a></h5><p>​		举个例子</p><div class="codeBlockContainer_I0IT language-java theme-code-block"><div class="codeBlockContent_wNvx java"><pre tabindex="0" class="prism-code language-java codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">        TestBean tb = new TestBean();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        BeanWrapper bw = new BeanWrapperImpl(tb);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        bw.registerCustomEditor(String.class, null, new PropertyEditorSupport() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            public void setAsText(String text) throws IllegalArgumentException {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                setValue(&quot;prefix&quot; + text);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        });</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            bw.setPropertyValue(&quot;name&quot;, &quot;value&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            bw.setPropertyValue(&quot;touchy&quot;, &quot;value&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        catch (BeansException ex) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            fail(&quot;Should not throw BeansException: &quot; + ex.getMessage());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        assertEquals(&quot;prefixvalue&quot;, bw.getPropertyValue(&quot;name&quot;));</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>​		当调用setPropertyValue的时候将会执行setValue 方法，通过这个方法在name的加上一个前缀， 先前讲到 factoryBean 就是一个工厂bean， spring 将 factoryBean 的名字和普通实例类的名字做了区分， 如果是FactoryBean的话，会在前缀上面加上 <code>&amp;</code>, spring 也就是用registerCustomEditor 做到的。 比如StudentFactoryBean的名字是studentFactoryBean, 那么增加到</p><p>​		</p><ol><li>ClassPathXmlApplicationContext</li><li>FileSystemXmlApplicationContext</li><li>StaticWebApplicationContext</li><li>XmlWebApplicationContext</li><li>ComplexWebApplicationContext</li><li>SimpleWebApplicationContext</li></ol></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-tags-row row margin-bottom--sm"><div class="col"><b>Tags:</b><ul class="tags_XVD_ padding--none margin-left--sm"><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/docs/tags/spring">spring</a></li><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/docs/tags/java">java</a></li></ul></div></div><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/spring/2019-01-01-spring-container.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_dcUD" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_foO9"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/google-guice/google-guice-source"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Google guice 框架源码学习</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/api/docusaurus-config"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">docusaurus.config.js</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_cNA8 thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#一-staticlistablebeanfactory" class="table-of-contents__link toc-highlight">一. StaticListableBeanFactory</a><ul><li><a href="#1继承分析" class="table-of-contents__link toc-highlight">1.	继承分析</a></li><li><a href="#2-代码实战" class="table-of-contents__link toc-highlight">2. 代码实战</a></li><li><a href="#3-源码分析" class="table-of-contents__link toc-highlight">3. 源码分析</a></li><li><a href="#3-小结" class="table-of-contents__link toc-highlight">3. 小结</a></li></ul></li><li><a href="#二-xmlbeanfactory" class="table-of-contents__link toc-highlight">二. XmlBeanFactory</a><ul><li><a href="#1-继承分析" class="table-of-contents__link toc-highlight">1. 继承分析</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/intro">Tutorial</a></li></ul></div><div class="col footer__col"><div class="footer__title">Repository</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/jeesk" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Github<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://gitee.com/jeesk" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Gitee<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">Github加速器</div><ul class="footer__items"><li class="footer__item"><a href="https://toolwa.com/github/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>toolwa<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="http://shrill-pond-3e81.hunsh.workers.dev" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>hunsh<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 山间草夫, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.d6c809c7.js"></script>
<script src="/assets/js/main.0c9f8076.js"></script>
</body>
</html>